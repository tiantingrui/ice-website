(window.webpackJsonp=window.webpackJsonp||[]).push([[64],{428:function(v,t,_){"use strict";_.r(t);var e=_(22),s=Object(e.a)({},(function(){var v=this,t=v.$createElement,_=v._self._c||t;return _("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[_("h1",{attrs:{id:"node-js的进程管理"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#node-js的进程管理"}},[v._v("#")]),v._v(" Node.js的进程管理")]),v._v(" "),_("h3",{attrs:{id:"操作系统的进程和线程"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#操作系统的进程和线程"}},[v._v("#")]),v._v(" 操作系统的进程和线程")]),v._v(" "),_("ul",[_("li",[v._v("运行任务的程序叫做“进程”，一个进程只能执行一个任务")]),v._v(" "),_("li",[v._v("进程并发：以多进程形式，允许多个任务同时运行")]),v._v(" "),_("li",[v._v("线程并发：以多线程形式，允许单个任务分成不同的部分运行")]),v._v(" "),_("li",[v._v("操作系统是提供协调机制，防止冲突，共享资源")]),v._v(" "),_("li",[v._v("JavaScript是单线程语言，所以多个任务只能排队进行")])]),v._v(" "),_("h3",{attrs:{id:"多进程vs多线程"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#多进程vs多线程"}},[v._v("#")]),v._v(" 多进程vs多线程")]),v._v(" "),_("table",[_("thead",[_("tr",[_("th",[v._v("维度")]),v._v(" "),_("th",[v._v("多进程")]),v._v(" "),_("th",[v._v("多线程")]),v._v(" "),_("th",[v._v("比较")])])]),v._v(" "),_("tbody",[_("tr",[_("td",[v._v("数据共享")]),v._v(" "),_("td",[v._v("数据共享复杂，需要用IPC；数据是分开的，同步简单")]),v._v(" "),_("td",[v._v("因为共享进程数据，数据共享简单，同步复杂")]),v._v(" "),_("td",[v._v("各有千秋")])]),v._v(" "),_("tr",[_("td",[v._v("资源利用")]),v._v(" "),_("td",[v._v("占用内存多，切换复杂，CPU利用率低")]),v._v(" "),_("td",[v._v("占用内存少，切换简单，CPU利用率高")]),v._v(" "),_("td",[v._v("多线程更好")])]),v._v(" "),_("tr",[_("td",[v._v("性能开销")]),v._v(" "),_("td",[v._v("创建销毁，切换复杂，速度慢")]),v._v(" "),_("td",[v._v("创建销毁，切换简单，速度很快")]),v._v(" "),_("td",[v._v("多线程更好")])]),v._v(" "),_("tr",[_("td",[v._v("编码实践")]),v._v(" "),_("td",[v._v("编码简单、调式方便")]),v._v(" "),_("td",[v._v("编码、调试复杂")]),v._v(" "),_("td",[v._v("多进程更好")])]),v._v(" "),_("tr",[_("td",[v._v("可靠性")]),v._v(" "),_("td",[v._v("进程独立运行，不会相互影响")]),v._v(" "),_("td",[v._v("线程同呼吸共命运")]),v._v(" "),_("td",[v._v("多进程更好")])]),v._v(" "),_("tr",[_("td",[v._v("分布式支持")]),v._v(" "),_("td",[v._v("可用于多机多核分布式，易于拓展")]),v._v(" "),_("td",[v._v("只能用于多核分布式")]),v._v(" "),_("td",[v._v("多进程更好")])])])]),v._v(" "),_("h3",{attrs:{id:"event-loop"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#event-loop"}},[v._v("#")]),v._v(" Event Loop")]),v._v(" "),_("ul",[_("li",[v._v("JavaScript 通过EventLoop 的形式解决单线程任务调度问题")]),v._v(" "),_("li",[v._v("EventLoop 是一个程序结构，用于等待和发送消息和事件")]),v._v(" "),_("li",[v._v("浏览器的EventLoop和Node的EventLoop是两个概念")])]),v._v(" "),_("h4",{attrs:{id:"浏览器的-eventloop"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#浏览器的-eventloop"}},[v._v("#")]),v._v(" 浏览器的 EventLoop")]),v._v(" "),_("h4",{attrs:{id:"nodejs的-eventloop"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#nodejs的-eventloop"}},[v._v("#")]),v._v(" Nodejs的 EventLoop")]),v._v(" "),_("h3",{attrs:{id:"nodejs-进程-process"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#nodejs-进程-process"}},[v._v("#")]),v._v(" Nodejs 进程 - process")]),v._v(" "),_("ul",[_("li",[v._v("process 是一个全局对象，无需require 直接使用，提供进程描述")]),v._v(" "),_("li",[v._v("process对象是 EventEmiter 的实例，暴露了进程事件的钩子\n"),_("ul",[_("li",[v._v("exit 监听进程退出")]),v._v(" "),_("li",[v._v("uncaughtException 监听异常")])])]),v._v(" "),_("li",[v._v("提供标准流输出，对应的是进程的 I/O 操作\n"),_("ul",[_("li",[v._v("node 版本的 console 底层是由 stdio 实现的")]),v._v(" "),_("li",[v._v("数据流与其他双工数据流不同，同步写会阻塞进程导致性能开销")])])])]),v._v(" "),_("h3",{attrs:{id:"nodejs-进程创建-child-process-cluster"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#nodejs-进程创建-child-process-cluster"}},[v._v("#")]),v._v(" Nodejs 进程创建 - child_process/cluster")]),v._v(" "),_("ul",[_("li",[v._v("child_process 是 Node.js 的内置模块\n"),_("ul",[_("li",[v._v("spawn：适用于返回大量数据，例如图像处理，二进制数据处理")]),v._v(" "),_("li",[v._v("exec：适用于小量数据，maxBuffer 默认值为 200 * 1024 超出奔溃")]),v._v(" "),_("li",[v._v("fork：衍生新的进程，进程 之间是仙湖独立的，每个进程独立")])])]),v._v(" "),_("li",[v._v("cluster 是 Node.js的内置模块\n"),_("ul",[_("li",[v._v("Worker 对象包含了关于工作进程的所有的公共的信息和方法")]),v._v(" "),_("li",[v._v("fork：衍生新的进程，进程之间是相互独立的，每个进程独立")]),v._v(" "),_("li",[v._v("使用主从模型轮询处理服务的负载任务，通过IPC通信")])])])]),v._v(" "),_("h3",{attrs:{id:"进程守护"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#进程守护"}},[v._v("#")]),v._v(" 进程守护")]),v._v(" "),_("ul",[_("li",[v._v("最佳实践说：该挂就挂，挂了怎么自启动？")]),v._v(" "),_("li",[v._v("进程并发：以多进程形式，允许多个任务同时运行")]),v._v(" "),_("li",[v._v("线程并发：以多线程形式，允许单个任务分成不同的部分运行")]),v._v(" "),_("li",[v._v("操作系统提供协调机制，防止冲突，共享资源")]),v._v(" "),_("li",[v._v("JavaScript是单线程语言，所以多个任务只能排队进行")])]),v._v(" "),_("p",[_("strong",[v._v("使用工具实现进程守护 pm2 forever")])])])}),[],!1,null,null,null);t.default=s.exports}}]);